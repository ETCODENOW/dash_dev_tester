import express from 'express';
import { KAppOptions, KStartOptions } from './options';
import { EventCallback, EventResources } from './event';
import { KLogger } from './logger';
import { Manifest } from './manifest';
import * as components from './components';
import * as api from './api';
/**
 * Kustomer App
 */
export declare class KApp<KAppSettings = any> {
    readonly options: KAppOptions;
    /**
     * triggered when your app is installed
     * @param userId user that installed the app
     * @param orgId org that the app was installed in
     */
    onInstall?: (userId: string, orgId: string) => void;
    /**
     * triggered when your app is enabled
     * @param userId user that enabled the app
     * @param orgId org that the app was enabled in
     */
    onEnable?: (userId: string, orgId: string) => void;
    /**
     * triggered when your app is disabled
     * @param userId user that disabled the app
     * @param orgId org that the app was disabled in
     */
    onDisable?: (userId: string, orgId: string) => void;
    /**
     * app logger instance that can be used to log to stdout.
     * To view use `set DEBUG=kapp*`
     */
    readonly log: KLogger;
    /**
     * express app instance
     */
    get app(): express.Application;
    private readonly _app;
    private _server?;
    /**
     * the apps manifest that acts as the apps version state
     */
    get manifest(): Manifest;
    private readonly _manifest;
    /**
     * environment base urls
     */
    get baseUrls(): {
        gateway: string;
        api: string;
        web: string;
    } | {
        gateway: string;
        api: string;
        web: string;
    } | {
        gateway: string;
        api: string;
        web: string;
    } | {
        gateway: string;
        api: string;
        web: string;
    };
    private _startedAt?;
    private readonly _token;
    private readonly _commands;
    private readonly _events;
    private readonly _hooks;
    /**
     * Kustomer App
     */
    constructor(options: KAppOptions);
    /**
     * start app server and publish new app version if necessary
     * @param options properties used to configure app server startup
     */
    start(options?: KStartOptions): Promise<void>;
    /**
     * stop app server
     */
    stop(): Promise<void>;
    /**
     * in an org, make a request
     * @param identifier the name, id, or token of the org
     */
    org(identifier: string): api.Orgs<KAppSettings>;
    /**
     * add a command to the app that will be created on install
     * @param name name of command (unique)
     * @param options command options
     * @param callback method that will be called when the action is triggered
     */
    onCommand(name: string, callback: components.CommandCallback): void;
    onCommand(name: string, options: components.CommandOptions, callback: components.CommandCallback): void;
    /**
     * listen for a hook `[POST] /orgs/:org/hooks/:hook`
     * @param name name of hook (unique)
     * @param callback
     */
    onHook<Q = any, H = any, B = any>(name: string, callback: (org: string, query: Q, headers: H, body: B) => any): void;
    /**
     * listen for auth requests
     * `[GET] /auth`
     * @param callback
     */
    onAuth(callback: express.RequestHandler): void;
    /**
     * listen for auth redirect requests
     * `[GET] /auth/redirect`
     * @param callback
     */
    onAuthComplete(callback: express.RequestHandler): void;
    /**
     * subscribe to a system event
     * @param resource data type
     * @param action action being performed on data type
     */
    on<R extends keyof EventResources, A extends keyof EventResources[R]>(resource: R, action: A, callback: EventCallback<EventResources[R][A]>): void;
    /**
     * add a Klass to the app that will be created on install
     * @param name name of the klass (unique)
     * @param options options to create a klass
     */
    useKlass(name: string, options: components.KlassOptions): void;
    /**
     * add a KView to the app that will be created on install
     * @param name name of the kview (unique)
     * @param jsxOrPath string representation of what Kustomer will attempt to render. This can be vanilla HTML, JS, JSX,
     * or a relative file path to a view you want to iframe.
     * @param options options to create a kview
     */
    useView(name: string, jsxOrPath: string, options: components.KViewOptions): void;
    /**
     * add a settings view that will be rendered via iframe
     * `[GET] /views/settings`
     * @param title page title
     * @param description page description
     * @param pathTo path to the build directory that contains your index.html
     */
    useSettings(title: string, description: string, pathTo: string): void;
    /**
     * add setup steps that will be rendered via iframe
     * @param pathTo path to the build directory that contains your index.html
     */
    useSetup(pathTo: string): void;
    private _onHealth;
    private _onInstall;
    private _onEnable;
    private _onDisable;
    private _onCommand;
    private _onEvent;
    private _onHook;
}
